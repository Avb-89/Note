https://bookflow.ru/ustanovka-i-nastrojka-1s-na-centos-8/


Установка и настройка 1С на CentOS 8
05.02.20200387
Установка и настройка 1С на CentOS 8
Сервер 1С это один из компонентов программного продукта 1С Предприятие предназначенный для организации работы клиент — серверной версии программы 1С Предприятие. Сама же программа 1С Предприятие предназначена для комплексной автоматизации предприятий по части бухгалтерского и управленческого учета в предприятии.

В сегодняшней статье мы расскажем вам как выполняется установка 1С на CentOS 8. В статье предполагается что у вас в наличие уже имеются дистрибутивы программ сервер 1С Предприятие. Внимание!!! Все действия в статье производятся от имени пользователя root.

УСТАНОВКА 1С СЕРВЕРА НА CENTOS 8
ШАГ 1. УСТАНОВКА ПАКЕТОВ 1С
Сперва установим пакеты сервера полученные вами от компании 1С. Перейдем под пользователя root:

$ su
Установка 1С на CentOS 8
Установка 1С на CentOS 8
Затем перейдем в папку, где у вас расположены установочные пакеты 1С сервера и выполняем групповую установку пакетов следующей командой:

$ yum install *
Установка и настройка 1С на CentOS 8

Этой командой мы выполняем одновременную установку всех пакетов сервера платформы 1С Предприятие находящихся в папке. Вывод команды:

Установка и настройка 1С на CentOS 8

Установка пакетов происходит в директорию /opt/1C/v8.3/x86_64.

ШАГ 2. УСТАНОВКА ШРИФТОВ ДЛЯ 1С
Далее установим шрифты Microsoft Core Fonts необходимые для корректной работы платформы 1С Linux. Они необходимы в том случае, если вы будете пользоваться платформой 1С Предприятие на вашем CentOS 8 сервере. Если вы планируете только удаленное подключение к базе на сервере 1С Предприятие, то установку шрифтов можно пропустить.

Шрифты необходимо скачать по следующей ссылке. Скачать будет необходимо все файлы exe шрифтов, за исключением файла под именем wd97vwr32.exe, поскольку в них содержаться файлы шрифтов.

После того, как шрифты были скачаны переименовываем поочередно exe файлы меняя им расширение с exe на zip и распаковываем их удаляя в получившихся папках все файлы кроме файлов *.ttf (файлы шрифтов).

Установка и настройка 1С на CentOS 8

Установка и настройка 1С на CentOS 8

Установка и настройка 1С на CentOS 8

Затем переносим все файлы шрифтов в одну папку по пути /usr/share/fonts/Core_Fonts и обновляем кэш шрифтов следующей командой:

$ fc-cache –fv
Установка и настройка 1С на CentOS 8

Данная команда обновит кэш шрифтов и система увидит необходимые шрифты.

ШАГ 3. УСТАНОВКА ЗАВИСИМОСТЕЙ
Теперь перейдем к установке дополнительных библиотек необходимых для корректной работы сервера 1С Предприятие. Установка выполняется следующей командой:

$ yum install fontconfig freetype libgsf unixODBC
Установка и настройка 1С на CentOS 8

Установка и настройка 1С на CentOS 8

ШАГ 4. ЗАПУСК СЛУЖБЫ
Теперь сервер 1С CentOS почти установлен. После установки пакетов запускаем службу сервера 1С Предприятие следующей командой:

$ systemctl start srv1cv83
Установка и настройка 1С на CentOS 8

После этого вы можете проверить запустилась ли служба сервера или нет выполнив команду:

$ systemctl status srv1cv83
Установка и настройка 1С на CentOS 8

ШАГ 5. УСТАНОВКА ДРАЙВЕРА HASP
После запуска сервера 1С Предприятие необходимо установить драйвер программной и аппаратной защиты HASP. Производим установку пакета haspd-7.90-eter2centos.x86_64.rpm следующей командой:

$ rpm -i http://ftp.etersoft.ru/pub/Etersoft/HASP/last/x86_64/CentOS/7/haspd-7.90-eter2centos.x86_64.rpm
Установка и настройка 1С на CentOS 8

Затем устанавливаем второй пакет драйвера защиты командой:

$ rpm -i http://ftp.etersoft.ru/pub/Etersoft/HASP/last/x86_64/CentOS/7/haspd-modules-7.90-eter2centos.x86_64.rpm
Установка и настройка 1С на CentOS 8

ШАГ 6. УСТАНОВКА POSTGRESQL
Теперь мы можем перейти к установке специализированной базы данных postgreSQL предназначенной для работы с сервером 1С Предприятие. Установка postgresql 1С CentOS выполняется из стороннего репозиториях. Сперва импортируем ключ GPG репозитория postgreSQL командой:

$ rpm --import http://repo.postgrespro.ru/keys/GPG-KEY-POSTGRESPRO
Установка и настройка 1С на CentOS 8

Затем создадим файл репозитория postgrespro-1c с помощью следующей команды:

$ echo [postgrespro-1c] > /etc/yum.repos.d/postgrespro-1c.repo
Установка и настройка 1С на CentOS 8

Затем пропишем имя репозитория командой:

$ echo name=Postgres Pro 1C repo >> /etc/yum.repos.d/postgrespro-1c.repo
Установка и настройка 1С на CentOS 8

Далее прописываем базовый URL:

$ echo baseurl=http://repo.postgrespro.ru//pg1c-archive/pg1c-12.1/centos/8/os/x86_64/rpms/ >> /etc/yum.repos.d/postgrespro-1c.repo
Установка и настройка 1С на CentOS 8

После включаем проверку GPG подписи пакетов:

$ echo gpgcheck=1 >> /etc/yum.repos.d/postgrespro-1c.repo
Установка и настройка 1С на CentOS 8

и включаем репозиторий:

$ echo enabled=1 >> /etc/yum.repos.d/postgrespro-1c.repo
Установка и настройка 1С на CentOS 8

Теперь нам необходимо обновить кэш пакетов с включенным репозиторием postgreSQL. Выполняется это действие следующей командой:

$ yum makecache
Установка и настройка 1С на CentOS 8

После производим установку пакетов postgreSQL:

$ yum install -y postgrespro-1c-12-server-12.1-1.el8.x86_64 postgrespro-1c-12-contrib-12.1-1.el8.x86_64
Установка и настройка 1С на CentOS 8

которая установит необходимый набор пакетов для запуска базы данных.

Вывод команды представлен на рисунке ниже.

Установка и настройка 1С на CentOS 8

По выполнении установки необходимо инициализировать базу данных следующей командой:

$ /opt/pgpro/1c-12/bin/pg-setup initdb
Установка и настройка 1С на CentOS 8

А так же добавить базу данных в автозагрузку. Для этого наберите:

$ /opt/pgpro/1c-12/bin/pg-setup service enable
Установка и настройка 1С на CentOS 8

ШАГ 7. НАСТРОЙКА POSTGRESQL
Запускаем сервер базы данных postgreSQL:

$ service postgrespro-1c-12 start
Установка и настройка 1С на CentOS 8

Перейдем под пользователя postgres командой:

$ su - postgres
Установка и настройка 1С на CentOS 8

Затем перейдем в каталог установки SQL сервера. Для этого введите команду:

$ cd /opt/pgpro/1c-12/bin/
Установка и настройка 1С на CentOS 8

Теперь войдем в базу данных:

$ ./psql
Установка и настройка 1С на CentOS 8

Войдя в пользователя postgres необходимо задать пароль пользователя для того, чтобы была возможность удаленно подключиться к базе данных. Выполняется это действие при помощи команды:

$ ALTER USER postgres WITH ENCRYPTED PASSWORD 'yourpassword';
Установка и настройка 1С на CentOS 8

Настройка 1С CentOS завершена, осталось создать базу или импортировать уже существующую.

ШАГ 8. ПОДКЛЮЧЕНИЕ К СЕРВЕРУ 1С
После того, как был задан пароль пользователя postgres запускаем на windows машине консоль администрирования серверов 1С Предприятия. В консоли выбираем пункт меню Создать — Новый центральный сервер

Установка и настройка 1С на CentOS 8

Заполняем поля имя и IP порт:

Установка и настройка 1С на CentOS 8

Далее переходим в созданный нами центральный сервер и создаем новый кластер. Для этого находясь в новом центральном сервере выбираем пункт меню Создать — Новый кластер:

Установка и настройка 1С на CentOS 8

Заполняем поля: имя кластер, компьютер, IP порт. Порт ставим по умолчанию 1541.

Установка и настройка 1С на CentOS 8

Теперь создаем информационную базу. Переходим в созданный кластер в пункт Информационные базы. Находясь в пункте Информационные базы заходим в меню Создать — Новая информационная база.

Установка и настройка 1С на CentOS 8

Заполняем поля имя, сервер баз данных, тип СУБД указываем postgreSQL. В поле база данных указываем имя создаваемой базы, в поле пользователь сервера БД указываем имя пользователя postgres и пароль заданный ранее. Устанавливаем галочку в чекбоксе Создать базу данных в случае ее отсутствия и нажимаем кнопку ОК. Таким образом мы создали базу данных на сервере 1С.

Установка и настройка 1С на CentOS 8

ВЫВОДЫ
Вот и все. Установка 1С на CentOS 8 полностью завершена. Теперь у вас имеется установленный и полностью готовый к работе сервер 1С Предприятие на котором вы можете создать базу данных или же загрузить вашу текущую базу данных из файловой версии 1С предприятия и приступать к работе. Спасибо за внимание.