http://tokarchuk.ru/2015/06/hyper-v-inside-vmware/

Если делать всё в лоб, т.е. просто поставить виртуалку с виндой и попробовать добавить туда роль Hyper-V, то гостевая ОС поймёт, что она собственно в гостях, и добавлять роль не будет. Она выплюнет сообщение такого плана:
view source
print
?
1.
Hyper-v cannot be installed a hypervisor is already running
Значит надо обмануть её, чтобы она думала, что работает на реальном железе. К счастью в VMWare такой механизм есть.

Решение
1. Выключаем гостевую машину с Windows 2012.
2. В vCenter/vClient щёлкаем по иконки с виртуалкой и из контекстного меню выбираем: All vCenter Actions -> Remove from Inventory. Это операция называется unregister VM.
3. Вклчаем ssh на хосте esxi, если он ещё не был включен.
4. С помощью WinSCP (Windows) или проводника Nautilus (Ubuntu) коннектимся к хосту esxi. Заходим на /vmfs/volumes/имя-datastore/папка-с-виртуалкой и с помощью notepad/gedit открываем файл *.vmx с конфигом виртуалки.
5. Меняем параметр guestOS на новый.
view source
print
?
1.
guestOS = "WindowsHyperVGuest"
6. Добавляем строки (можно под него)
view source
print
?
1.
vhv.enable = "TRUE"
2.
hypervisor.cpuid.v0 = "FALSE"
7. Если редактировали файл на сервере, сохраняем его и закрываем редактор. Если у себя на компе, то сохраняемся и закачиваем (перезаписывая файл).
8. В vCenter/vClient открываем datastore: Storage -> правый клик на нужный datastore -> из контекстного меню выбираем «Browse files».
9. Заходим в папку с виртуалкой, делаем правый клик на наш *.vmx файл и из контекстного меню выбираем Register VM. Далее выбираем наш датацентр, и после нажатия ок и выполнения задачи в списке задач ждём, когда вирутуалка появится в списке для нужного нам хоста.
10. Правый клик на виртуалке -> Edit Settings -> Options -> CPU/MMU Virtualization. В выпадающем списке выбираем Hardware CPU and MMU (нижний вариант).
11. В свойствах виртуалки выбираем VM Options -> General Options -> Guest OS Version и меняем значение «Oher (32-bit)» на «Other (64-bit)».
12. Запускаем виртуалку, и пробуем добавить роль Hyper-V. Теперь всё должно получиться!